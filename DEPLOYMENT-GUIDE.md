# Complete Deployment Guide

## üöÄ Three Ways to Deploy

### Option 1: Complete GUI Setup (Recommended for First Time)

**File:** `Deploy-Complete.ps1`

This is the **all-in-one solution** with GUI for API key management:

```powershell
.\Deploy-Complete.ps1
```

**What it does:**
1. Shows GUI form for secure API key entry
2. Saves keys encrypted to `api-keys.json`
3. Checks and installs required tools (Git, Node, Vercel CLI)
4. Updates `.env` with your API keys
5. Generates `JWT_SECRET` and `CRON_SECRET` automatically
6. Installs all dependencies
7. Starts backend with health check validation
8. Starts frontend (if exists) and opens browser
9. Offers to deploy to Vercel

**Perfect for:**
- First-time setup
- When you want a guided experience
- When you need to update API keys
- Testing full stack locally before deployment

---

### Option 2: Simple Deployment (Recommended for Regular Use)

**File:** `deploy-unified-simple.ps1`

Fast deployment to Vercel & Render:

```powershell
# Deploy to both platforms
.\deploy-unified-simple.ps1

# Deploy to specific platform
.\deploy-unified-simple.ps1 -Platform vercel
.\deploy-unified-simple.ps1 -Platform render
```

**What it does:**
1. Checks requirements (Git, Node, Vercel CLI)
2. Verifies `.env` file exists
3. Installs dependencies
4. Configures automation
5. Deploys to Vercel and/or Render

**Perfect for:**
- Quick deployments
- CI/CD automation
- When `.env` is already configured

---

### Option 3: Environment Sync Only

**File:** `Sync-EnvVars.ps1`

Sync environment variables to cloud platforms:

```powershell
# Preview what will be synced
.\Sync-EnvVars.ps1 -DryRun

# Sync to both platforms
.\Sync-EnvVars.ps1

# Sync to specific platform
.\Sync-EnvVars.ps1 -Platform vercel
.\Sync-EnvVars.ps1 -Platform render
```

**What it does:**
1. Reads your `.env` file
2. Generates missing secrets (`JWT_SECRET`, `CRON_SECRET`)
3. Syncs variables to Vercel automatically
4. Creates `render-env-config.txt` for Render dashboard

**Perfect for:**
- Updating environment variables
- Syncing config after adding new API keys
- Migrating to new deployment

---

## üìã Complete Workflow

### First-Time Setup

```powershell
# 1. Run complete setup with GUI
.\Deploy-Complete.ps1

# 2. Test automation locally
node master-automation.js --status
node master-automation.js --immediate

# 3. Deploy to production (already offered in step 1, but you can run again)
.\deploy-unified-simple.ps1
```

### Regular Deployment

```powershell
# Quick deployment
.\deploy-unified-simple.ps1
```

### Updating Configuration

```powershell
# Update API keys via GUI
.\Deploy-Complete.ps1

# Or manually edit .env, then sync
.\Sync-EnvVars.ps1
```

---

## üîê API Keys Management

### Secure Storage

All three scripts support secure API key storage:

- **GUI Method** (`Deploy-Complete.ps1`): Enter keys in form, saved encrypted
- **Manual Method**: Edit `.env` directly
- **Sync Method** (`Sync-EnvVars.ps1`): Reads from `.env` and syncs to cloud

### Required API Keys

```env
# Required for automation
PRINTFUL_API_KEY=<from Printful dashboard>

# Required for security
JWT_SECRET=<auto-generated>
CRON_SECRET=<auto-generated>
ALLOWED_ORIGINS=https://yourdomain.com
```

### Optional API Keys

```env
# Design automation
CANVA_API_KEY=<from Canva developers>
CANVA_BRAND_TEMPLATE_ID=<your template ID>

# Payments
STRIPE_API_KEY=<from Stripe dashboard>

# AI features
OPENAI_API_KEY=<from OpenAI>

# Error monitoring
SENTRY_DSN=<from Sentry.io>
```

---

## üéØ Platform-Specific Instructions

### Vercel

**Automatic:**
```powershell
# Scripts handle Vercel automatically
.\Deploy-Complete.ps1
# or
.\deploy-unified-simple.ps1
```

**Manual:**
1. Install Vercel CLI: `npm install -g vercel`
2. Run: `vercel --prod`
3. Configure env vars: `vercel env add KEY_NAME production`

**Verify:**
- Dashboard: https://vercel.com/dashboard
- Check deployment logs
- Test your production URL

### Render

**Via Script:**
```powershell
# Creates config file for you
.\Sync-EnvVars.ps1 -Platform render
```

**Manual:**
1. Push code to GitHub
2. Go to https://dashboard.render.com
3. Create new Web Service
4. Connect to your GitHub repository
5. Add environment variables from `render-env-config.txt`
6. Deploy!

**Auto-deployment:**
- Render watches your GitHub repository
- Automatically deploys on push to main branch
- Configure in Render dashboard settings

---

## üß™ Testing

### Local Testing

```powershell
# Start development server
npm run dev

# Test automation against local server
node master-automation.js --immediate

# Check status
node master-automation.js --status

# View logs
Get-Content data\master-automation.log -Tail 50 -Wait
```

### Production Testing

```powershell
# Set production URL
$env:SERVER_URL="https://your-app.vercel.app"

# Test automation
node master-automation.js --immediate

# Check health endpoint
curl https://your-app.vercel.app/api/health
```

---

## üîß Troubleshooting

### "Backend failed to start"

**Solution:**
```powershell
# Check if port 3000 is in use
Get-NetTCPConnection -LocalPort 3000 -ErrorAction SilentlyContinue

# Kill process if needed
Stop-Process -Name node -Force

# Try again
.\Deploy-Complete.ps1
```

### "Vercel deployment failed"

**Solution:**
```powershell
# Login to Vercel
vercel login

# Link project
vercel link

# Try deployment again
vercel --prod
```

### "Missing API keys"

**Solution:**
```powershell
# Use GUI to add keys
.\Deploy-Complete.ps1

# Or manually edit .env
notepad .env

# Then sync
.\Sync-EnvVars.ps1
```

### "Module not found"

**Solution:**
```powershell
# Reinstall dependencies
Remove-Item node_modules -Recurse -Force
npm install

# Rebuild native modules
npm rebuild sqlite3
```

---

## üìä Comparison Matrix

| Feature | Deploy-Complete | deploy-unified-simple | Sync-EnvVars |
|---------|----------------|----------------------|--------------|
| GUI API Key Entry | ‚úÖ Yes | ‚ùå No | ‚ùå No |
| Encrypted Storage | ‚úÖ Yes | ‚ùå No | ‚ùå No |
| Auto-generate Secrets | ‚úÖ Yes | ‚ùå No | ‚úÖ Yes |
| Start Backend | ‚úÖ Yes | ‚ùå No | ‚ùå No |
| Start Frontend | ‚úÖ Yes | ‚ùå No | ‚ùå No |
| Health Check | ‚úÖ Yes | ‚ùå No | ‚ùå No |
| Deploy to Vercel | ‚úÖ Yes | ‚úÖ Yes | ‚ùå No |
| Deploy to Render | ‚ö†Ô∏è Partial | ‚úÖ Yes | ‚ö†Ô∏è Config File |
| Sync Env Vars | ‚ùå No | ‚ùå No | ‚úÖ Yes |
| Best For | First Setup | Quick Deploy | Env Updates |

---

## üéØ Recommended Workflow

### 1. Initial Setup
```powershell
# Complete GUI setup
.\Deploy-Complete.ps1
```

### 2. Regular Development
```powershell
# Local development
npm run dev

# Test changes
node master-automation.js --immediate
```

### 3. Deploy Updates
```powershell
# Quick deployment
.\deploy-unified-simple.ps1
```

### 4. Update Configuration
```powershell
# When adding new API keys
.\Deploy-Complete.ps1  # Use GUI

# Or sync manually edited .env
.\Sync-EnvVars.ps1
```

---

## ‚úÖ Pre-Deployment Checklist

- [ ] All API keys configured
- [ ] `.env` file exists and is complete
- [ ] Dependencies installed (`npm install`)
- [ ] Local server starts without errors
- [ ] Automation runs successfully locally
- [ ] Git repository is up to date
- [ ] Environment variables synced to Vercel/Render
- [ ] Production deployment tested
- [ ] Health endpoint responds correctly

---

## üöÄ Quick Reference

```powershell
# Complete setup with GUI
.\Deploy-Complete.ps1

# Fast deployment
.\deploy-unified-simple.ps1

# Sync environment variables
.\Sync-EnvVars.ps1

# Test locally
npm run dev
node master-automation.js --immediate

# View status
node master-automation.js --status

# View logs
Get-Content data\master-automation.log -Tail 50 -Wait
```

---

**Last Updated:** 2025-11-12
**Version:** 2.0.0
**Status:** Production Ready ‚úÖ
